# Mito_Plot
Variant Plot Considering All Heterozygosity Rates in Large-Scale Samples

# Mitochondrial Heteroplasmy Analysis and Visualization

This repository contains scripts to calculate mitochondrial DNA heteroplasmy from VCF files and visualize the results in an interactive circular plot.

In addition to the original 2D interactive plots which allow free zooming and panning, the tool now supports generating interactive 3D circular plots.

This enhancement enables detailed visualization of aggregated variants and heteroplasmy rates across large cohorts, providing better insight into complex mutation patterns that were difficult to explore with previous 2D-only visualizations.

## Files

- `step1.py`:  
  Processes multiple mitochondrial VCF files (*.vcf) to calculate heteroplasmy rates at each variant position. Outputs a merged TSV file summarizing heteroplasmy rates per sample and position.

- `step2.py`:  
  Loads the merged TSV from run_step1.py and generates an interactive Plotly circular plot showing heteroplasmy rates by position with mitochondrial gene regions annotated.
  This script creates a 2D figure, where zoom in/out and panning on desired regions are freely possible for detailed inspection.

- `step3.py`:  
  Loads the merged TSV from run_step1.py and generates an interactive 3D circular plot representing heteroplasmy rates across samples.
  The plot positions samples along the Z-axis with compressible height for better visualization of multiple samples and mitochondrial gene regions annotated in 3D.
  The Volume_dot 3D Result can be viewed.

- `step4.py`:
  
  This repository includes a script to load merged TSV data generated by run_step1.py and visualize mitochondrial heteroplasmy rates interactively using a 3D circular plot. The visualization positions samples along the Z-axis with adjustable height compression to improve clarity for large sample sets. Each mitochondrial gene region is annotated and distinctly colored in 3D.
  Compared to step3.py, this script replaces the original figure with smoothed (approximated) curves to better illustrate clustering and accumulation patterns of heteroplasmic variants. The plot supports fine-grained inspection by gene region, allowing users to select and zoom into specific mitochondrial regions interactively via a dropdown menu. This enhances the clarity and interpretability of variant distributions within and across gene regions.
  The application accepts input TSV files via command-line arguments, enabling flexible data usage.
  Users can view detailed heteroplasmy rates and variant counts by hovering over data points, and interactively explore different gene regions for comprehensive mitochondrial variant analysis.

## Usage

1. Prepare a directory containing your mitochondrial VCF files named like `sample1_chrM.vcf`.

2. Run step Plotting a 2D Plot:
python step2.py All_YYYMMDD.tsv

3. Run step Plotting a 3D Plot:
python step3.py All_YYYMMDD.tsv


[MT_Plot_Sample_2D.pdf](https://github.com/user-attachments/files/22736247/MT_Plot_Sample_2D.pdf)

[MT_Plot_Sample_3D_Volume_dot.pdf](https://github.com/user-attachments/files/22842773/MT_Plot_Sample_3D_Volume_dot.pdf)

[MT_Plot_Sample_3D_Line.pdf](https://github.com/user-attachments/files/22842769/MT_Plot_Sample_3D_Line.pdf)

[MT_Plot_Sample_3D_Line_Region.pdf](https://github.com/user-attachments/files/22842764/MT_Plot_Sample_3D_Line_Region.pdf)










## Input File Specification

The software expects input VCF files generated on the GRCh38 reference genome (VCF v4 format), with the chromosome column (CHROM) labeled as chrM. This is the standard convention for mitochondrial DNA in GRCh38-based VCF data.
