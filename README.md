# Mito_Plot
Variant Plot Considering All Heterozygosity Rates in Large-Scale Samples

# Mitochondrial Heteroplasmy Analysis and Visualization

This repository contains scripts to calculate mitochondrial DNA heteroplasmy 
from VCF files and visualize the results in an interactive circular plot.

In addition to the original 2D interactive plots which allow free zooming and panning, 
the tool now supports An interactive Dash/Plotly-based visualization tool for mitochondrial DNA (mtDNA)
heteroplasmy across samples, rendered as a 3D circular genome map.

This enhancement enables detailed visualization of aggregated variants and 
heteroplasmy rates across large cohorts, providing better insight into 
complex mutation patterns that were difficult to explore with previous 2D-only visualizations.

This tool maps variant positions onto the human mitochondrial genome (rCRS),
encoding heteroplasmy levels radially and sample prevalence vertically.


## Features

- 3D circular visualization of mtDNA variants
- rCRS-based gene annotation
- Radial encoding of heteroplasmy levels
- Vertical encoding of sample prevalence
- Interactive gene-level filtering (Dash UI)
- Hover-based inspection of variant details


## Requirements

- Python 3.9+
- pandas
- numpy
- plotly
- dash
- matplotlib


## Installation

clone the repository:
git clone https://github.com/Nakamara/Mito_Plot.git
cd mtdna-heteroplasmy-viewer


## Files

- `step1.py`:
  
  Processes multiple mitochondrial VCF files (*.vcf) to calculate heteroplasmy rates at each variant position. Outputs a merged TSV file summarizing heteroplasmy rates per sample and position.

- `step2.py`:
   
  Loads the merged TSV from run_step1.py and generates an interactive Plotly circular plot showing heteroplasmy rates by position with mitochondrial gene regions annotated.
  This script creates a 2D figure, where zoom in/out and panning on desired regions are freely possible for detailed inspection.

- `step3.py`:
  
  Loads the merged TSV from run_step1.py and generates an interactive 3D circular plot representing heteroplasmy rates across samples.
  The plot positions samples along the Z-axis with compressible height for better visualization of multiple samples and mitochondrial gene regions annotated in 3D.
  The Volume_dot 3D Result can be viewed.

- `step4.py`:
  
  This repository includes a script to load merged TSV data generated by run_step1.py and visualize mitochondrial heteroplasmy rates interactively using a 3D circular plot. The visualization scales samples along the Z-axis by sample count with adjustable height compression to improve clarity for large sample sets. Each mitochondrial gene region is annotated and distinctly colored in 3D.Compared to step3.py, this script visualizes the data using 3D line plots. The Z-axis is scaled by sample count to better illustrate clustering and accumulation patterns of heteroplasmic variants across samples.
 The plot supports fine-grained inspection by gene region, allowing users to select and zoom into specific mitochondrial regions interactively via a dropdown menu. This enhances the clarity and interpretability of variant distributions within and across gene regions.Users can view detailed heteroplasmy rates, variant counts, and sample counts by hovering over data points for comprehensive mitochondrial variant analysis across cohorts.

## Test_Data
  We have prepared two files: small_sample and large_sample.The small_sample dataset consists of 5 samples and should be used as the main test dataset.
For this dataset, a VCF file has been prepared.
The large_sample dataset contains data from 116 individuals that have already been processed.
Please start from Step 2 using the large_sample dataset.





## Usage

1. Prepare a directory containing your mitochondrial VCF files named like `sample1_chrM.vcf`. : python step1.py /path/to/vcf_directory [--output output.tsv]

2. Run step Plotting a 2D Plot:
python step2.py All_YYYMMDD.tsv

3. Run step Plotting a 3D Plot(Dot_Plot):
python step3.py All_YYYMMDD.tsv

4. Run step Plotting a 3D Plot(Line):
python step4.py All_YYYMMDD.tsv


[MT_Plot_Sample_2D.pdf](https://github.com/user-attachments/files/22736247/MT_Plot_Sample_2D.pdf)

[MT_Plot_Sample_3D_Volume_dot.pdf](https://github.com/user-attachments/files/22842773/MT_Plot_Sample_3D_Volume_dot.pdf)

[MT_Plot_Sample_3D_Line.pdf](https://github.com/user-attachments/files/24587460/MT_Plot_Sample_3D_Line.pdf)

[MT_Plot_Sample_3D_Line_Region.pdf](https://github.com/user-attachments/files/24587456/MT_Plot_Sample_3D_Line_Region.pdf)


## Input File Specification

The software expects input VCF files generated on the GRCh38 reference genome (VCF v4 format), with the chromosome column (CHROM) labeled as chrM. This is the standard convention for mitochondrial DNA in GRCh38-based VCF data.

Input file format
The input TSV file must follow this structure:

chrM    Position    Ref    Alt    sample1    sample2    ...

Position: mtDNA coordinate (1–16569, rCRS)
Heteroplasmy values may be:
Fractions (0–1)
Percentages (12%)
Numeric values (12 → interpreted as 12%)






## License

Mito_Plot is provided as open source under the MIT License.

The contents of the LICENSE are described below.

MIT License

Copyright (c) 2026 <Kohta Nakamura / Juntendo Univ>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.


## Disclaimer
This software is provided for research and visualization purposes only.
No clinical or diagnostic use is intended.







